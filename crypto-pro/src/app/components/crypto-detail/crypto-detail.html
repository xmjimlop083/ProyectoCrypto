@if (crypto(); as crypto) {
<div class="container mt-4 mb-5">
  <!-- Cabecera -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <div class="d-flex align-items-center mb-3">
        <img [src]="crypto.image.large" [alt]="crypto.name" width="64" height="64" class="me-3">
        <div>
          <h1 class="card-title mb-0 d-flex align-items-center gap-2">
            {{ crypto.name }}
            <span class="text-muted fs-4 text-uppercase">({{ crypto.symbol }})</span>
            <span class="badge bg-secondary fs-6">Rank #{{ crypto.market_cap_rank }}</span>
          </h1>
        </div>
      </div>
      <h2 class="display-4 fw-bold text-primary">
        {{ crypto.market_data.current_price.eur | currency:'EUR' }}
      </h2>
    </div>
  </div>

  <div class="row">
    <!-- Info Financiera -->
    <div class="col-lg-5 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header bg-light">
          <h5 class="mb-0">Estadísticas de Mercado</h5>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="text-muted">Capitalización de Mercado</span>
            <span class="fw-bold">{{ crypto.market_data.market_cap.eur | currency:'EUR':'symbol':'1.0-0' }}</span>
          </li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="text-muted">Volumen 24h</span>
            <span class="fw-bold">{{ crypto.market_data.total_volume.eur | currency:'EUR':'symbol':'1.0-0' }}</span>
          </li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="text-muted">Suministro Circulante</span>
            <span class="fw-bold">{{ crypto.market_data.circulating_supply | number:'1.0-0' }} {{ crypto.symbol | uppercase }}</span>
          </li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="text-muted">Máximo Histórico (ATH)</span>
            <span class="fw-bold">{{ crypto.market_data.ath.eur | currency:'EUR' }}</span>
          </li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="text-muted">Cambio ATH (%)</span>
            <span class="fw-bold text-danger">{{ crypto.market_data.ath_change_percentage.eur | number:'1.2-2' }}%</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Gráfico -->
    <div class="col-lg-7 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header bg-light">
          <h5 class="mb-0">Historial de Precio (7 días)</h5>
        </div>
        <div class="card-body">
          <div style="display: block;">
            <canvas baseChart width="400" height="200"
              [data]="chartData"
              [options]="chartOptions"
              [type]="chartType">
            </canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Descripción -->
  <div class="card mb-4 shadow-sm" *ngIf="crypto.description.en">
    <div class="card-header bg-light">
      <h5 class="mb-0">Sobre {{ crypto.name }}</h5>
    </div>
    <div class="card-body">
      <div [innerHTML]="crypto.description.en" class="crypto-description"></div>
    </div>
  </div>

  <!-- Enlaces Externos -->
  <div class="d-flex gap-3">
    <a *ngIf="crypto.links.homepage[0]" [href]="crypto.links.homepage[0]" target="_blank" class="btn btn-outline-primary">
      <i class="bi bi-globe"></i> Sitio Web Oficial
    </a>
    <a *ngIf="crypto.links.blockchain_site[0]" [href]="crypto.links.blockchain_site[0]" target="_blank" class="btn btn-outline-secondary">
      <i class="bi bi-link-45deg"></i> Explorador Blockchain
    </a>
  </div>
</div>
} @else {
  <div class="d-flex justify-content-center align-items-center vh-100">
    @if (loading()) {
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    } @else {
      <div class="text-center">
        <div class="alert alert-warning mb-3">
          No se pudo cargar la información de la criptomoneda.
        </div>
        <a class="btn btn-primary" routerLink="/list">Volver al listado</a>
      </div>
    }
  </div>
}
